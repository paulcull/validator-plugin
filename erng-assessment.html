<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Entity Resolution & Network Generation Assessment</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js (Pinned Version for Stability) -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" crossorigin="anonymous"></script>
    
    <!-- Plotly.js (Canvas/WebGL) -->
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js" crossorigin="anonymous"></script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@300;400;700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">

    <style>
        /* --- Chosen Palette: Warm Neutrals & Earth Tones --- */
        body {
            font-family: 'Open Sans', sans-serif;
            background-color: #fafaf9; /* Stone 50 */
            color: #44403c; /* Stone 700 */
            line-height: 1.6;
        }

        h1, h2, h3, h4 {
            font-family: 'Merriweather', serif;
            color: #292524;
        }

        /* --- Chart Container Logic --- */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin: 0 auto;
            /* Explicit height for Chart.js to respect */
            height: 350px; 
            max-height: 400px;
        }

        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #e7e5e4; }
        ::-webkit-scrollbar-thumb { background: #a8a29e; border-radius: 4px; }
        
        /* Navigation Active State */
        .nav-item.active {
            border-bottom: 3px solid #a16207;
            color: #292524;
            font-weight: 600;
        }

        /* Card Interactions */
        .info-card {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .info-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        /* Button Styles */
        .btn-primary {
            background-color: #44403c;
            color: #fafaf9;
            transition: all 0.2s;
        }
        .btn-primary:hover { background-color: #292524; }
    </style>
</head>
<body class="bg-stone-50">

    <!-- Navigation -->
    <nav class="sticky top-0 z-50 bg-white/90 backdrop-blur border-b border-stone-200 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <span class="text-xl font-serif font-bold text-stone-800 tracking-tight">Data<span class="text-yellow-700">Coherence</span></span>
                </div>
                <div class="hidden md:flex space-x-8 items-center">
                    <button onclick="scrollToSection('intro')" class="nav-item active px-3 py-2 text-sm text-stone-600 hover:text-stone-900">Context</button>
                    <button onclick="scrollToSection('landscape')" class="nav-item px-3 py-2 text-sm text-stone-600 hover:text-stone-900">Market</button>
                    <button onclick="scrollToSection('comparison')" class="nav-item px-3 py-2 text-sm text-stone-600 hover:text-stone-900">Analysis</button>
                    <button onclick="scrollToSection('network')" class="nav-item px-3 py-2 text-sm text-stone-600 hover:text-stone-900">Network Gen</button>
                    <button onclick="scrollToSection('verdict')" class="nav-item px-3 py-2 text-sm text-stone-600 hover:text-stone-900">Verdict</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-10 space-y-16">

        <!-- Section 1: Introduction -->
        <section id="intro" class="text-center space-y-6 animate-fade-in">
            <h1 class="text-4xl md:text-5xl font-bold text-stone-800 leading-tight">
                The State of <span class="text-yellow-700">Entity Resolution</span> & <span class="text-lime-700">Network Generation</span>
            </h1>
            <p class="max-w-3xl mx-auto text-lg text-stone-600 leading-relaxed">
                In an era of fragmented data, knowing "who is who" (Entity Resolution) and "who knows whom" (Network Generation) is the foundation of modern analytics. This report assesses the trade-offs between <strong>Commercial Platforms</strong> and <strong>Open Source Libraries</strong>.
            </p>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-8">
                <div class="bg-white p-6 rounded-lg shadow-sm border border-stone-100">
                    <div class="text-3xl mb-2">üß©</div>
                    <h3 class="font-bold text-stone-800">Entity Resolution</h3>
                    <p class="text-sm text-stone-500 mt-2">Identifying records referring to the same real-world entity.</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-sm border border-stone-100">
                    <div class="text-3xl mb-2">üï∏Ô∏è</div>
                    <h3 class="font-bold text-stone-800">Network Gen</h3>
                    <p class="text-sm text-stone-500 mt-2">Connecting resolved entities to reveal hidden relationships.</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-sm border border-stone-100">
                    <div class="text-3xl mb-2">‚öñÔ∏è</div>
                    <h3 class="font-bold text-stone-800">The Dilemma</h3>
                    <p class="text-sm text-stone-500 mt-2">Speed and Support vs. Control and Cost-Efficiency.</p>
                </div>
            </div>
        </section>

        <!-- Section 2: Market Landscape -->
        <section id="landscape" class="bg-white rounded-xl shadow-sm border border-stone-200 p-8">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
                <div class="space-y-4">
                    <div class="border-l-4 border-yellow-600 pl-4">
                        <h2 class="text-2xl font-bold text-stone-800">The Shifting Landscape</h2>
                        <p class="text-stone-500 text-sm uppercase tracking-wide">Market Adoption Trends</p>
                    </div>
                    <p class="text-stone-600">
                        The market is bifurcating: enterprises with strict compliance needs are moving to sophisticated <strong>Commercial COTS</strong> solutions, while tech-forward companies are embracing <strong>Probabilistic Open Source</strong> libraries.
                    </p>
                    <ul class="space-y-3 mt-4">
                        <li class="flex items-start">
                            <span class="text-lime-600 mr-2">‚úì</span>
                            <span class="text-stone-600 text-sm"><strong>Commercial:</strong> Banking, Gov, Insurance.</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-lime-600 mr-2">‚úì</span>
                            <span class="text-stone-600 text-sm"><strong>Open Source:</strong> Tech, Startups, Data Science.</span>
                        </li>
                    </ul>
                </div>
                
                <div class="flex flex-col items-center w-full">
                    <h3 class="text-stone-700 font-semibold mb-4">Current Deployment Strategies</h3>
                    <div class="chart-container">
                        <canvas id="marketChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 3: Comparative Analysis -->
        <section id="comparison" class="space-y-8">
            <div class="text-center max-w-2xl mx-auto">
                <h2 class="text-3xl font-bold text-stone-800">Commercial vs. Open Source</h2>
                <p class="text-stone-600 mt-2">
                    An in-depth assessment of the five critical dimensions of deployment.
                </p>
            </div>

            <div class="bg-white rounded-xl shadow-lg border border-stone-200 overflow-hidden">
                <div class="flex border-b border-stone-200 bg-stone-50">
                    <button onclick="switchTab('overview')" id="tab-overview" class="flex-1 py-4 text-center font-semibold text-stone-800 border-b-2 border-yellow-600 bg-white">Strategic Overview</button>
                    <button onclick="switchTab('contenders')" id="tab-contenders" class="flex-1 py-4 text-center font-semibold text-stone-500 border-b-2 border-transparent">Top Contenders Details</button>
                </div>

                <div class="p-8">
                    <!-- Tab: Strategic Overview -->
                    <div id="view-overview" class="block animate-fade-in">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-10">
                            <div class="chart-container">
                                <canvas id="radarChart"></canvas>
                            </div>
                            <div class="space-y-6 flex flex-col justify-center">
                                <div class="p-4 bg-yellow-50 rounded-lg border border-yellow-100">
                                    <h4 class="font-bold text-yellow-800 mb-2">Commercial Profile</h4>
                                    <p class="text-sm text-stone-600">High <strong>Speed to Value</strong>. High TCO.</p>
                                </div>
                                <div class="p-4 bg-lime-50 rounded-lg border border-lime-100">
                                    <h4 class="font-bold text-lime-800 mb-2">Open Source Profile</h4>
                                    <p class="text-sm text-stone-600">High <strong>Transparency</strong>. Engineering heavy.</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tab: Contenders -->
                    <div id="view-contenders" class="hidden animate-fade-in">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-12">
                            <div>
                                <h3 class="font-bold text-lg text-stone-800 mb-4">Senzing (Commercial)</h3>
                                <div class="chart-container" style="height: 250px;">
                                    <canvas id="commercialBar"></canvas>
                                </div>
                            </div>
                            <div>
                                <h3 class="font-bold text-lg text-stone-800 mb-4">Splink (Open Source)</h3>
                                <div class="chart-container" style="height: 250px;">
                                    <canvas id="osBar"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 4: Network Generation Visualizer -->
        <section id="network" class="space-y-6">
            <div class="flex flex-col md:flex-row justify-between items-end border-b border-stone-300 pb-4">
                <div class="max-w-2xl">
                    <h2 class="text-2xl font-bold text-stone-800">From Resolution to <span class="text-rose-600">Network Generation</span></h2>
                    <p class="text-stone-600 mt-2">
                        Linking resolved entities via shared attributes builds a <strong>Knowledge Graph</strong> that reveals hidden risks and opportunities.
                    </p>
                </div>
                <div class="mt-4 md:mt-0">
                    <button id="toggleNetworkBtn" class="btn-primary px-6 py-2 rounded-lg font-semibold shadow-md text-sm">
                        Simulate Connection
                    </button>
                </div>
            </div>

            <!-- Plotly Container -->
            <div class="bg-stone-900 rounded-xl shadow-inner p-4 border border-stone-800 relative">
                <div id="networkGraph" style="width: 100%; height: 500px;"></div>
                <div class="text-center text-stone-500 text-xs mt-2">
                    Interactive Canvas: Zoom, Pan, and Hover to explore relationships.
                </div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mt-8">
                <div class="p-4 bg-white border-l-4 border-stone-300 rounded shadow-sm">
                    <h4 class="font-bold text-sm text-stone-700">1. Ingest</h4>
                </div>
                <div class="p-4 bg-white border-l-4 border-yellow-500 rounded shadow-sm">
                    <h4 class="font-bold text-sm text-stone-700">2. Resolve (ER)</h4>
                </div>
                <div class="p-4 bg-white border-l-4 border-lime-500 rounded shadow-sm">
                    <h4 class="font-bold text-sm text-stone-700">3. Link (Edges)</h4>
                </div>
                <div class="p-4 bg-white border-l-4 border-rose-500 rounded shadow-sm">
                    <h4 class="font-bold text-sm text-stone-700">4. Graph</h4>
                </div>
            </div>
        </section>

        <!-- Section 5: Verdict -->
        <section id="verdict" class="py-8">
            <h2 class="text-3xl font-bold text-center text-stone-800 mb-10">Final Verdict</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="bg-white rounded-xl shadow-lg border border-yellow-200 p-6 info-card">
                    <div class="text-yellow-800 font-bold text-2xl mb-2">Senzing</div>
                    <p class="text-stone-600 text-sm">Best for Enterprise & Real-time APIs. Zero training required.</p>
                </div>
                <div class="bg-white rounded-xl shadow-lg border border-lime-200 p-6 info-card">
                    <div class="text-lime-800 font-bold text-2xl mb-2">Splink</div>
                    <p class="text-stone-600 text-sm">Best for Data Science & Batch Analytics. Probabilistic SQL backend.</p>
                </div>
            </div>
        </section>

    </main>

    <!-- Application Logic -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            
            // --- Helper: Scroll ---
            window.scrollToSection = function(id) {
                const element = document.getElementById(id);
                if (element) {
                    element.scrollIntoView({ behavior: 'smooth' });
                    document.querySelectorAll('.nav-item').forEach(btn => btn.classList.remove('active'));
                    // Simple logic to set active class based on click, simplified for this demo
                }
            };

            // --- Helper: Tab Switch ---
            window.switchTab = function(viewId) {
                document.getElementById('view-overview').classList.add('hidden');
                document.getElementById('view-contenders').classList.add('hidden');
                document.getElementById('view-' + viewId).classList.remove('hidden');

                const btnOverview = document.getElementById('tab-overview');
                const btnContenders = document.getElementById('tab-contenders');

                if (viewId === 'overview') {
                    btnOverview.className = 'flex-1 py-4 text-center font-semibold text-stone-800 border-b-2 border-yellow-600 bg-white';
                    btnContenders.className = 'flex-1 py-4 text-center font-semibold text-stone-500 border-b-2 border-transparent';
                } else {
                    btnContenders.className = 'flex-1 py-4 text-center font-semibold text-stone-800 border-b-2 border-yellow-600 bg-white';
                    btnOverview.className = 'flex-1 py-4 text-center font-semibold text-stone-500 border-b-2 border-transparent';
                }
            };

            // --- Helper: Split Labels ---
            function splitLabel(label) {
                if (typeof label !== 'string' || label.length <= 16) return label;
                const words = label.split(' ');
                const lines = [];
                let currentLine = words[0];
                for (let i = 1; i < words.length; i++) {
                    if (currentLine.length + 1 + words[i].length <= 16) {
                        currentLine += ' ' + words[i];
                    } else {
                        lines.push(currentLine);
                        currentLine = words[i];
                    }
                }
                lines.push(currentLine);
                return lines;
            }

            // --- CHART 1: Market Landscape ---
            const cvsMarket = document.getElementById('marketChart');
            if (cvsMarket) {
                new Chart(cvsMarket, {
                    type: 'doughnut',
                    data: {
                        labels: ['Commercial Solutions', 'Open Source', 'Legacy / In-House', 'Manual / None'].map(splitLabel),
                        datasets: [{
                            data: [35, 25, 30, 10],
                            backgroundColor: ['#a16207', '#4d7c0f', '#a8a29e', '#e7e5e4'],
                            borderWidth: 0
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { legend: { position: 'bottom' } }
                    }
                });
            }

            // --- CHART 2: Radar ---
            const cvsRadar = document.getElementById('radarChart');
            if (cvsRadar) {
                new Chart(cvsRadar, {
                    type: 'radar',
                    data: {
                        labels: ['Deployment Speed', 'Cost Efficiency', 'Customizability', 'Scalability', 'Support Quality'].map(splitLabel),
                        datasets: [{
                            label: 'Commercial',
                            data: [9, 3, 4, 9, 10],
                            fill: true,
                            backgroundColor: 'rgba(161, 98, 7, 0.2)',
                            borderColor: '#a16207',
                            pointBackgroundColor: '#a16207'
                        }, {
                            label: 'Open Source',
                            data: [4, 10, 10, 8, 3],
                            fill: true,
                            backgroundColor: 'rgba(77, 124, 15, 0.2)',
                            borderColor: '#4d7c0f',
                            pointBackgroundColor: '#4d7c0f'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: { r: { suggestedMin: 0, suggestedMax: 10 } }
                    }
                });
            }

            // --- CHARTS 3 & 4: Bars ---
            const barOptions = {
                indexAxis: 'y',
                responsive: true,
                maintainAspectRatio: false,
                scales: { x: { max: 10, grid: { display: false } }, y: { grid: { display: false } } },
                plugins: { legend: { display: false } }
            };

            const cvsComm = document.getElementById('commercialBar');
            if (cvsComm) {
                new Chart(cvsComm, {
                    type: 'bar',
                    data: {
                        labels: ['Accuracy', 'Speed', 'Ease of Use', 'Integration'].map(splitLabel),
                        datasets: [{ data: [9.5, 9.8, 9.0, 8.5], backgroundColor: '#a16207', borderRadius: 4 }]
                    },
                    options: barOptions
                });
            }

            const cvsOS = document.getElementById('osBar');
            if (cvsOS) {
                new Chart(cvsOS, {
                    type: 'bar',
                    data: {
                        labels: ['Accuracy', 'Speed', 'Ease of Use', 'Integration'].map(splitLabel),
                        datasets: [{ data: [9.0, 8.5, 6.5, 7.0], backgroundColor: '#4d7c0f', borderRadius: 4 }]
                    },
                    options: barOptions
                });
            }

            // --- PLOTLY: NETWORK GRAPH ANIMATION ---
            
            const nodeCount = 40;
            // 1. Define Initial State (Random Chaos)
            const chaosX = Array.from({length: nodeCount}, () => Math.random() * 10);
            const chaosY = Array.from({length: nodeCount}, () => Math.random() * 10);
            const colors = chaosX.map((_, i) => i % 3 === 0 ? '#be123c' : (i % 3 === 1 ? '#06b6d4' : '#78716c'));
            
            // 2. Define Organized State (Clusters)
            const clusterCenters = [{x: 2.5, y: 2.5}, {x: 7.5, y: 7.5}, {x: 2.5, y: 7.5}, {x: 7.5, y: 2.5}];
            const organizedX = [];
            const organizedY = [];
            
            for (let i = 0; i < nodeCount; i++) {
                const center = clusterCenters[i % 4];
                // Nodes gravitate near centers
                organizedX.push(center.x + (Math.random() - 0.5) * 2.5);
                organizedY.push(center.y + (Math.random() - 0.5) * 2.5);
            }

            // 3. Initialize Plot
            // Trace 0: Edges (Lines) - Initially empty
            let traceEdges = {
                x: [], y: [], mode: 'lines', type: 'scattergl',
                line: { color: 'rgba(255, 255, 255, 0.15)', width: 1 }, hoverinfo: 'none'
            };

            // Trace 1: Nodes (Markers)
            let traceNodes = {
                x: [...chaosX], y: [...chaosY], mode: 'markers', type: 'scattergl',
                marker: { size: 10, color: colors, line: { color: 'white', width: 1 } },
                hoverinfo: 'none'
            };

            const layout = {
                plot_bgcolor: 'rgba(0,0,0,0)', paper_bgcolor: 'rgba(0,0,0,0)',
                showlegend: false,
                xaxis: { showgrid: false, zeroline: false, showticklabels: false, range: [-1, 11] },
                yaxis: { showgrid: false, zeroline: false, showticklabels: false, range: [-1, 11] },
                margin: { l: 0, r: 0, b: 0, t: 0 },
                dragmode: 'pan'
            };
            
            Plotly.newPlot('networkGraph', [traceEdges, traceNodes], layout, {responsive: true, displayModeBar: false});

            // 4. Manual Animation Loop (The Fix)
            let isConnected = false;
            let animationFrameId = null;

            document.getElementById('toggleNetworkBtn').addEventListener('click', function() {
                const btn = this;
                
                // Determine Start and End positions based on current state
                const startX = isConnected ? organizedX : chaosX;
                const startY = isConnected ? organizedY : chaosY;
                const targetX = isConnected ? chaosX : organizedX;
                const targetY = isConnected ? chaosY : organizedY;
                
                const startTime = performance.now();
                const duration = 1500; // ms

                // Update Button State immediately
                isConnected = !isConnected;
                btn.textContent = isConnected ? "Reset View" : "Simulate Connection";
                btn.classList.toggle('btn-primary');
                btn.classList.toggle('bg-stone-200');
                btn.classList.toggle('text-stone-800');

                // Cancel any running animation
                if (animationFrameId) cancelAnimationFrame(animationFrameId);

                function animate(currentTime) {
                    const elapsed = currentTime - startTime;
                    const progress = Math.min(elapsed / duration, 1);
                    
                    // Easing (Cubic In/Out)
                    const ease = progress < 0.5 ? 4 * progress * progress * progress : 1 - Math.pow(-2 * progress + 2, 3) / 2;

                    // Interpolate Nodes
                    const currentX = startX.map((s, i) => s + (targetX[i] - s) * ease);
                    const currentY = startY.map((s, i) => s + (targetY[i] - s) * ease);

                    // Calculate Edges dynamically
                    const currentEdgeX = [];
                    const currentEdgeY = [];
                    const opacity = isConnected ? ease : (1 - ease); // Fade in if connecting, out if resetting

                    if (opacity > 0.05) {
                        for (let i = 0; i < nodeCount; i++) {
                            const center = clusterCenters[i % 4];
                            // Only draw edge if we are somewhat organized
                            if (Math.random() > 0.3) { 
                                currentEdgeX.push(currentX[i], center.x, null);
                                currentEdgeY.push(currentY[i], center.y, null);
                            }
                        }
                    }

                    // Update Plotly using 'react' (Fastest update method for full data swap)
                    Plotly.react('networkGraph', [
                        { ...traceEdges, x: currentEdgeX, y: currentEdgeY, line: { ...traceEdges.line, color: `rgba(255, 255, 255, ${opacity * 0.3})` } },
                        { ...traceNodes, x: currentX, y: currentY }
                    ], layout);

                    if (progress < 1) {
                        animationFrameId = requestAnimationFrame(animate);
                    }
                }

                animationFrameId = requestAnimationFrame(animate);
            });
        });
    </script>
</body>
</html>